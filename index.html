<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Teleprompter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #f8fafc;
            --text-primary: #ffffff;
            --text-secondary: #cbd5e1;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --accent-color: #06b6d4;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --border-color: #475569;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #1a202c 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow: hidden;
        }

        body.light-theme {
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e2e8f0;
            --border-color: #d1d5db;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* Control Panel */
        .control-panel {
            width: 400px;
            background: var(--bg-secondary);
            border-right: 2px solid var(--border-color);
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .control-panel.hidden {
            transform: translateX(-100%);
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .section {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .section h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .script-input {
            width: 100%;
            height: 150px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text-primary);
            font-family: 'Georgia', serif;
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .script-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .controls {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), #1d4ed8);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #059669);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #d97706);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #dc2626);
            color: white;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .slider-container {
            position: relative;
        }

        .slider {
            width: 100%;
            height: 6px;
            background: var(--bg-secondary);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .speed-display {
            text-align: center;
            margin-top: 0.5rem;
            font-weight: 600;
            color: var(--accent-color);
        }

        .progress-container {
            background: var(--bg-secondary);
            border-radius: 4px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            width: 0%;
            transition: width 0.3s ease;
        }

        .toggle-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .toggle-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .toggle-option label {
            font-weight: 500;
            margin: 0;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .toggle-switch.active {
            background: var(--primary-color);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
        }

        .theme-toggle {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 1001;
        }

        /* Teleprompter Display */
        .teleprompter-display {
            flex: 1;
            position: relative;
            background: var(--bg-primary);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .display-header {
            padding: 1rem 2rem;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .display-info {
            display: flex;
            gap: 2rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .scrolling-area {
            flex: 1;
            position: relative;
            overflow: hidden;
            padding: 2rem;
        }

        .script-content {
            font-family: 'Georgia', serif;
            font-size: 2.5rem;
            line-height: 1.8;
            color: var(--text-primary);
            text-align: center;
            padding: 50vh 2rem 100vh;
            transition: transform 0.1s linear;
            word-wrap: break-word;
        }

        .focus-line {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--danger-color), transparent);
            transform: translateY(-50%);
            z-index: 10;
            display: none;
        }

        .focus-line.active {
            display: block;
        }

        .reading-area {
            position: absolute;
            top: 40%;
            left: 10%;
            right: 10%;
            height: 20%;
            background: linear-gradient(
                to bottom,
                transparent 0%,
                rgba(37, 99, 235, 0.1) 20%,
                rgba(37, 99, 235, 0.1) 80%,
                transparent 100%
            );
            border-radius: 12px;
            z-index: 5;
            display: none;
        }

        .reading-area.active {
            display: block;
        }

        .fullscreen-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 20;
        }

        .panel-toggle {
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 20;
        }

        /* Keyboard shortcuts display */
        .shortcuts {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 20;
        }

        .shortcuts.show {
            opacity: 1;
        }

        .shortcuts h4 {
            margin-bottom: 0.5rem;
            color: var(--accent-color);
        }

        .shortcuts div {
            margin-bottom: 0.25rem;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .control-panel {
                width: 100%;
                height: auto;
                max-height: 40vh;
            }

            .script-content {
                font-size: 1.8rem;
                padding: 20vh 1rem 50vh;
            }

            .controls {
                justify-content: center;
            }

            .btn {
                font-size: 0.8rem;
                padding: 0.6rem 1rem;
            }
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .playing .btn-success {
            animation: pulse 2s infinite;
        }

        /* Fullscreen styles */
        .fullscreen .control-panel {
            display: none;
        }

        .fullscreen .teleprompter-display {
            width: 100vw;
            height: 100vh;
        }

        .fullscreen .display-header {
            display: none;
        }

        /* Status indicators */
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-stopped {
            background: var(--border-color);
        }

        .status-playing {
            background: var(--success-color);
            animation: pulse 1.5s infinite;
        }

        .status-paused {
            background: var(--warning-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Theme Toggle -->
        <button class="btn btn-secondary theme-toggle" onclick="toggleTheme()">
            <span id="theme-icon">🌙</span>
        </button>

        <!-- Control Panel -->
        <div class="control-panel" id="controlPanel">
            <div class="header">
                <h1>Professional Teleprompter</h1>
                <p>Advanced script scrolling system</p>
            </div>

            <!-- Script Input -->
            <div class="section">
                <h3>📝 Script Input</h3>
                <textarea 
                    class="script-input" 
                    id="scriptInput" 
                    placeholder="Enter your script here...

Try this sample:
Welcome to our professional teleprompter system. This application provides smooth scrolling, customizable speed controls, and professional features for broadcasting and presentations.

You can adjust the scrolling speed, toggle focus lines, and use keyboard shortcuts for easy control during your presentation.

Press the play button or spacebar to start scrolling your script!"
                ></textarea>
            </div>

            <!-- Transport Controls -->
            <div class="section">
                <h3>🎮 Transport Controls</h3>
                <div class="controls">
                    <button class="btn btn-success" id="playBtn" onclick="togglePlay()">
                        ▶️ Play
                    </button>
                    <button class="btn btn-warning" id="pauseBtn" onclick="pause()" style="display: none;">
                        ⏸️ Pause
                    </button>
                    <button class="btn btn-danger" onclick="stop()">
                        ⏹️ Stop
                    </button>
                    <button class="btn btn-secondary" onclick="reset()">
                        🔄 Reset
                    </button>
                </div>
            </div>

            <!-- Speed Control -->
            <div class="section">
                <h3>⚡ Speed Control</h3>
                <div class="control-group">
                    <label for="speedSlider">Scrolling Speed</label>
                    <div class="slider-container">
                        <input 
                            type="range" 
                            id="speedSlider" 
                            class="slider" 
                            min="10" 
                            max="200" 
                            value="60" 
                            onchange="updateSpeed()"
                        >
                        <div class="speed-display" id="speedDisplay">60 WPM</div>
                    </div>
                </div>
            </div>

            <!-- Progress -->
            <div class="section">
                <h3>📊 Progress</h3>
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary);">
                    <span id="currentTime">0:00</span>
                    <span id="totalTime">0:00</span>
                </div>
            </div>

            <!-- Display Options -->
            <div class="section">
                <h3>🎯 Display Options</h3>
                <div class="toggle-options">
                    <div class="toggle-option">
                        <label>Focus Line</label>
                        <div class="toggle-switch" id="focusLineToggle" onclick="toggleFocusLine()"></div>
                    </div>
                    <div class="toggle-option">
                        <label>Reading Area</label>
                        <div class="toggle-switch" id="readingAreaToggle" onclick="toggleReadingArea()"></div>
                    </div>
                </div>
            </div>

            <!-- Keyboard Shortcuts -->
            <div class="section">
                <h3>⌨️ Keyboard Shortcuts</h3>
                <div style="font-size: 0.8rem; color: var(--text-secondary); line-height: 1.6;">
                    <div><strong>SPACE:</strong> Play/Pause</div>
                    <div><strong>ESC:</strong> Stop/Reset</div>
                    <div><strong>↑↓:</strong> Adjust Speed</div>
                    <div><strong>F11:</strong> Fullscreen</div>
                    <div><strong>HOME:</strong> Go to Start</div>
                    <div><strong>H:</strong> Show/Hide Controls</div>
                </div>
            </div>
        </div>

        <!-- Teleprompter Display -->
        <div class="teleprompter-display">
            <!-- Panel Toggle Button -->
            <button class="btn btn-secondary panel-toggle" id="panelToggle" onclick="togglePanel()">
                📱 Controls
            </button>

            <!-- Fullscreen Button -->
            <button class="btn btn-primary fullscreen-btn" onclick="toggleFullscreen()">
                🔳 Fullscreen
            </button>

            <!-- Display Header -->
            <div class="display-header">
                <div class="display-info">
                    <span>
                        <span class="status-indicator" id="statusIndicator"></span>
                        <span id="statusText">Stopped</span>
                    </span>
                    <span>Speed: <span id="headerSpeed">60</span> WPM</span>
                    <span>Progress: <span id="headerProgress">0%</span></span>
                </div>
            </div>

            <!-- Scrolling Area -->
            <div class="scrolling-area" id="scrollingArea">
                <!-- Focus Line -->
                <div class="focus-line" id="focusLine"></div>
                
                <!-- Reading Area -->
                <div class="reading-area" id="readingArea"></div>

                <!-- Script Content -->
                <div class="script-content" id="scriptDisplay">
                    Enter your script in the control panel to begin...
                </div>
            </div>
        </div>
    </div>

    <!-- Keyboard Shortcuts Help -->
    <div class="shortcuts" id="shortcutsHelp">
        <h4>Keyboard Shortcuts</h4>
        <div><strong>SPACE:</strong> Play/Pause</div>
        <div><strong>ESC:</strong> Stop</div>
        <div><strong>↑↓:</strong> Speed ±10</div>
        <div><strong>F11:</strong> Fullscreen</div>
        <div><strong>HOME:</strong> Reset</div>
        <div><strong>H:</strong> Toggle Controls</div>
    </div>

    <script>
        // Teleprompter class
        class Teleprompter {
            constructor() {
                this.isPlaying = false;
                this.isPaused = false;
                this.speed = 60; // WPM
                this.position = 0;
                this.animationId = null;
                this.totalWords = 0;
                this.startTime = 0;
                this.pausedTime = 0;
                this.focusLineActive = false;
                this.readingAreaActive = false;
                this.isFullscreen = false;

                this.initializeElements();
                this.bindEvents();
                this.loadFromInput();
                this.updateDisplay();
            }

            initializeElements() {
                this.scriptInput = document.getElementById('scriptInput');
                this.scriptDisplay = document.getElementById('scriptDisplay');
                this.playBtn = document.getElementById('playBtn');
                this.pauseBtn = document.getElementById('pauseBtn');
                this.speedSlider = document.getElementById('speedSlider');
                this.speedDisplay = document.getElementById('speedDisplay');
                this.progressBar = document.getElementById('progressBar');
                this.currentTime = document.getElementById('currentTime');
                this.totalTime = document.getElementById('totalTime');
                this.statusIndicator = document.getElementById('statusIndicator');
                this.statusText = document.getElementById('statusText');
                this.headerSpeed = document.getElementById('headerSpeed');
                this.headerProgress = document.getElementById('headerProgress');
                this.focusLine = document.getElementById('focusLine');
                this.readingArea = document.getElementById('readingArea');
                this.focusLineToggle = document.getElementById('focusLineToggle');
                this.readingAreaToggle = document.getElementById('readingAreaToggle');
                this.controlPanel = document.getElementById('controlPanel');
                this.panelToggle = document.getElementById('panelToggle');
                this.shortcutsHelp = document.getElementById('shortcutsHelp');
            }

            bindEvents() {
                // Input change
                this.scriptInput.addEventListener('input', () => this.loadFromInput());

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));

                // Speed slider
                this.speedSlider.addEventListener('input', () => this.updateSpeed());

                // Show shortcuts on hover over display
                const display = document.querySelector('.teleprompter-display');
                display.addEventListener('mouseenter', () => this.showShortcuts());
                display.addEventListener('mouseleave', () => this.hideShortcuts());
            }

            loadFromInput() {
                const text = this.scriptInput.value.trim();
                this.scriptDisplay.textContent = text || 'Enter your script in the control panel to begin...';
                
                // Calculate total words
                this.totalWords = text ? text.split(/\s+/).length : 0;
                this.updateTotalTime();
                this.reset();
            }

            togglePlay() {
                if (this.isPlaying) {
                    this.pause();
                } else {
                    this.play();
                }
            }

            play() {
                if (!this.scriptInput.value.trim()) {
                    alert('Please enter a script first!');
                    return;
                }

                this.isPlaying = true;
                this.isPaused = false;
                
                if (this.startTime === 0) {
                    this.startTime = Date.now();
                } else if (this.pausedTime > 0) {
                    this.startTime += Date.now() - this.pausedTime;
                    this.pausedTime = 0;
                }

                this.playBtn.style.display = 'none';
                this.pauseBtn.style.display = 'inline-flex';
                
                document.body.classList.add('playing');
                this.updateStatus('playing', 'Playing');
                this.animate();
            }

            pause() {
                this.isPlaying = false;
                this.isPaused = true;
                this.pausedTime = Date.now();

                this.playBtn.style.display = 'inline-flex';
                this.pauseBtn.style.display = 'none';
                
                document.body.classList.remove('playing');
                this.updateStatus('paused', 'Paused');

                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }
            }

            stop() {
                this.isPlaying = false;
                this.isPaused = false;
                this.position = 0;
                this.startTime = 0;
                this.pausedTime = 0;

                this.playBtn.style.display = 'inline-flex';
                this.pauseBtn.style.display = 'none';
                
                document.body.classList.remove('playing');
                this.updateStatus('stopped', 'Stopped');

                if (this.animationId) {
                    cancelAnimationFrame(this.animationId);
                }

                this.scriptDisplay.style.transform = 'translateY(0px)';
                this.updateProgress(0);
                this.updateCurrentTime(0);
            }

            reset() {
                this.stop();
                this.position = 0;
                this.scriptDisplay.style.transform = 'translateY(0px)';
            }

            animate() {
                if (!this.isPlaying) return;

                const pixelsPerSecond = this.speed * 2; // Adjust for visual speed
                const deltaTime = 16; // ~60fps
                
                this.position += (pixelsPerSecond * deltaTime) / 1000;
                this.scriptDisplay.style.transform = `translateY(-${this.position}px)`;

                // Calculate progress based on scroll position
                const maxScroll = this.scriptDisplay.scrollHeight - window.innerHeight;
                const progress = Math.min(this.position / maxScroll * 100, 100);
                this.updateProgress(progress);

                // Update elapsed time
                if (this.startTime > 0) {
                    const elapsed = (Date.now() - this.startTime) / 1000;
                    this.updateCurrentTime(elapsed);
                }

                // Check if finished
                if (progress >= 100) {
                    this.stop();
                    return;
                }

                this.animationId = requestAnimationFrame(() => this.animate());
            }

            updateSpeed() {
                this.speed = parseInt(this.speedSlider.value);
                this.speedDisplay.textContent = `${this.speed} WPM`;
                this.headerSpeed.textContent = this.speed;
                this.updateTotalTime();
            }

            updateProgress(percent) {
                this.progressBar.style.width = `${percent}%`;
                this.headerProgress.textContent = `${Math.round(percent)}%`;
            }

            updateCurrentTime(seconds) {
                this.currentTime.textContent = this.formatTime(seconds);
            }

            updateTotalTime() {
                if (this.totalWords > 0) {
                    const estimatedSeconds = (this.totalWords / this.speed) * 60;
                    this.totalTime.textContent = this.formatTime(estimatedSeconds);
                } else {
                    this.totalTime.textContent = '0:00';
                }
            }

            formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            updateStatus(status, text) {
                this.statusIndicator.className = `status-indicator status-${status}`;
                this.statusText.textContent = text;
            }

            updateDisplay() {
                this.updateSpeed();
                this.updateTotalTime();
                this.updateStatus('stopped', 'Stopped');
            }

            toggleFocusLine() {
                this.focusLineActive = !this.focusLineActive;
                this.focusLine.classList.toggle('active', this.focusLineActive);
                this.focusLineToggle.classList.toggle('active', this.focusLineActive);
            }

            toggleReadingArea() {
                this.readingAreaActive = !this.readingAreaActive;
                this.readingArea.classList.toggle('active', this.readingAreaActive);
                this.readingAreaToggle.classList.toggle('active', this.readingAreaActive);
            }

            togglePanel() {
                this.controlPanel.classList.toggle('hidden');
                this.panelToggle.textContent = this.controlPanel.classList.contains('hidden') 
                    ? '📱 Show Controls' 
                    : '📱 Hide Controls';
            }

            showShortcuts() {
                this.shortcutsHelp.classList.add('show');
            }

            hideShortcuts() {
                this.shortcutsHelp.classList.remove('show');
            }

            handleKeyboard(e) {
                // Prevent shortcuts when typing in input
                if (e.target === this.scriptInput) return;

                switch (e.code) {
                    case 'Space':
                        e.preventDefault();
                        this.togglePlay();
                        break;
                    case 'Escape':
                        e.preventDefault();
                        this.stop();
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        this.adjustSpeed(10);
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        this.adjustSpeed(-10);
                        break;
                    case 'Home':
                        e.preventDefault();
                        this.reset();
                        break;
                    case 'KeyH':
                        e.preventDefault();
                        this.togglePanel();
                        break;
                    case 'F11':
                        e.preventDefault();
                        toggleFullscreen();
                        break;
                }
            }

            adjustSpeed(delta) {
                const newSpeed = Math.max(10, Math.min(200, this.speed + delta));
                this.speedSlider.value = newSpeed;
                this.updateSpeed();
            }
        }

        // Initialize teleprompter
        let teleprompter;

        // Theme management
        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const icon = document.getElementById('theme-icon');
            icon.textContent = document.body.classList.contains('light-theme') ? '☀️' : '🌙';
            
            // Save theme preference
            localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
        }

        // Fullscreen management
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    document.body.classList.add('fullscreen');
                });
            } else {
                document.exitFullscreen().then(() => {
                    document.body.classList.remove('fullscreen');
                });
            }
        }

        // Global functions for buttons
        function togglePlay() {
            teleprompter.togglePlay();
        }

        function pause() {
            teleprompter.pause();
        }

        function stop() {
            teleprompter.stop();
        }

        function reset() {
            teleprompter.reset();
        }

        function updateSpeed() {
            teleprompter.updateSpeed();
        }

        function toggleFocusLine() {
            teleprompter.toggleFocusLine();
        }

        function toggleReadingArea() {
            teleprompter.toggleReadingArea();
        }

        function togglePanel() {
            teleprompter.togglePanel();
        }

        // Speech Recognition System
        class SpeechController {
            constructor() {
                this.recognition = null;
                this.isListening = false;
                this.commands = {
                    'start': () => teleprompter.play(),
                    'play': () => teleprompter.play(),
                    'begin': () => teleprompter.play(),
                    'stop': () => teleprompter.pause(),
                    'pause': () => teleprompter.pause(),
                    'wait': () => teleprompter.pause(),
                    'faster': () => teleprompter.increaseSpeed(),
                    'speed up': () => teleprompter.increaseSpeed(),
                    'slower': () => teleprompter.decreaseSpeed(),
                    'slow down': () => teleprompter.decreaseSpeed(),
                    'reset': () => teleprompter.reset(),
                    'beginning': () => teleprompter.reset(),
                    'top': () => teleprompter.reset(),
                    'fullscreen': () => teleprompter.toggleFullscreen(),
                    'full screen': () => teleprompter.toggleFullscreen()
                };
                this.initSpeechRecognition();
                this.createVoiceUI();
            }

            initSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    this.recognition = new SpeechRecognition();
                    this.recognition.continuous = true;
                    this.recognition.interimResults = false;
                    this.recognition.lang = 'en-US';

                    this.recognition.onresult = (event) => {
                        const command = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
                        this.processCommand(command);
                    };

                    this.recognition.onerror = (event) => {
                        console.log('Speech recognition error:', event.error);
                        this.updateVoiceStatus('error');
                    };
                }
            }

            processCommand(command) {
                console.log('Voice command:', command);
                for (const [keyword, action] of Object.entries(this.commands)) {
                    if (command.includes(keyword)) {
                        action();
                        this.showVoiceCommand(keyword);
                        break;
                    }
                }
            }

            toggleVoiceControl() {
                if (!this.recognition) {
                    alert('Speech recognition not supported in this browser');
                    return;
                }

                if (this.isListening) {
                    this.recognition.stop();
                    this.isListening = false;
                    this.updateVoiceStatus('off');
                } else {
                    this.recognition.start();
                    this.isListening = true;
                    this.updateVoiceStatus('listening');
                }
            }

            createVoiceUI() {
                const voicePanel = document.createElement('div');
                voicePanel.innerHTML = `
                    <div style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: var(--bg-secondary); border-radius: 10px; padding: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                        <h3 style="color: var(--text-primary); margin-bottom: 10px; font-size: 14px;">🎤 Voice Control</h3>
                        <button id="voiceToggle" onclick="speechController.toggleVoiceControl()" style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                            Start Voice Control
                        </button>
                        <div id="voiceStatus" style="margin-top: 8px; font-size: 12px; color: var(--text-secondary);">
                            Status: Off
                        </div>
                        <div id="lastCommand" style="margin-top: 5px; font-size: 11px; color: var(--text-secondary);">
                            Commands: start, stop, faster, slower, reset, fullscreen
                        </div>
                    </div>
                `;
                document.body.appendChild(voicePanel);
            }

            updateVoiceStatus(status) {
                const statusEl = document.getElementById('voiceStatus');
                const toggleBtn = document.getElementById('voiceToggle');
                
                switch(status) {
                    case 'listening':
                        statusEl.textContent = 'Status: Listening...';
                        statusEl.style.color = '#4CAF50';
                        toggleBtn.textContent = 'Stop Voice Control';
                        toggleBtn.style.background = '#f44336';
                        break;
                    case 'off':
                        statusEl.textContent = 'Status: Off';
                        statusEl.style.color = 'var(--text-secondary)';
                        toggleBtn.textContent = 'Start Voice Control';
                        toggleBtn.style.background = '#4CAF50';
                        break;
                    case 'error':
                        statusEl.textContent = 'Status: Error';
                        statusEl.style.color = '#f44336';
                        this.isListening = false;
                        break;
                }
            }

            showVoiceCommand(command) {
                const commandEl = document.getElementById('lastCommand');
                commandEl.textContent = `Last: "${command}"`;
                commandEl.style.color = '#4CAF50';
                setTimeout(() => {
                    commandEl.textContent = 'Commands: start, stop, faster, slower, reset, fullscreen';
                    commandEl.style.color = 'var(--text-secondary)';
                }, 2000);
            }
        }

        // Social Media Streaming System
        class SocialMediaStreamer {
            constructor() {
                this.connectedPlatforms = {};
                this.isStreaming = false;
                this.createStreamingUI();
            }

            createStreamingUI() {
                const streamPanel = document.createElement('div');
                streamPanel.innerHTML = `
                    <div style="position: fixed; top: 10px; left: 10px; z-index: 1000; background: var(--bg-secondary); border-radius: 10px; padding: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); max-width: 300px;">
                        <h3 style="color: var(--text-primary); margin-bottom: 15px; font-size: 14px;">📡 Live Streaming</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 15px;">
                            <button onclick="socialStreamer.connectPlatform('facebook')" style="background: #1877F2; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; font-size: 11px;">
                                📘 Facebook
                            </button>
                            <button onclick="socialStreamer.connectPlatform('youtube')" style="background: #FF0000; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; font-size: 11px;">
                                📺 YouTube
                            </button>
                            <button onclick="socialStreamer.connectPlatform('instagram')" style="background: #E4405F; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; font-size: 11px;">
                                📷 Instagram
                            </button>
                            <button onclick="socialStreamer.connectPlatform('twitch')" style="background: #9146FF; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; font-size: 11px;">
                                🟣 Twitch
                            </button>
                        </div>

                        <input id="streamTitle" placeholder="Stream title..." style="width: 100%; background: var(--bg-primary); border: 1px solid #333; color: var(--text-primary); padding: 8px; border-radius: 4px; font-size: 12px; margin-bottom: 10px;">
                        
                        <div style="display: flex; gap: 8px;">
                            <button id="goLiveBtn" onclick="socialStreamer.toggleStream()" style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 12px; flex: 1;">
                                🔴 Go Live
                            </button>
                        </div>
                        
                        <div id="streamStatus" style="margin-top: 10px; font-size: 11px; color: var(--text-secondary);">
                            Status: Ready to stream
                        </div>
                        
                        <div id="streamStats" style="margin-top: 5px; font-size: 10px; color: var(--text-secondary); display: none;">
                            👁️ Viewers: 0 | ⏱️ Duration: 00:00
                        </div>
                    </div>
                `;
                document.body.appendChild(streamPanel);
            }

            async connectPlatform(platform) {
                // Simulate OAuth connection
                const platformNames = {
                    facebook: 'Facebook Live',
                    youtube: 'YouTube Live', 
                    instagram: 'Instagram Live',
                    twitch: 'Twitch'
                };

                const success = confirm(`Connect to ${platformNames[platform]}? This will open authentication window.`);
                
                if (success) {
                    this.connectedPlatforms[platform] = true;
                    this.updateStreamStatus(`Connected to ${platformNames[platform]}`);
                    
                    // In real implementation, this would handle OAuth flow
                    console.log(`Connected to ${platform}`);
                } else {
                    this.updateStreamStatus('Connection cancelled');
                }
            }

            toggleStream() {
                const goLiveBtn = document.getElementById('goLiveBtn');
                const streamTitle = document.getElementById('streamTitle').value;
                
                if (!this.isStreaming) {
                    if (Object.keys(this.connectedPlatforms).length === 0) {
                        alert('Please connect to at least one platform first');
                        return;
                    }
                    
                    if (!streamTitle.trim()) {
                        alert('Please enter a stream title');
                        return;
                    }
                    
                    // Start streaming
                    this.isStreaming = true;
                    goLiveBtn.textContent = '⏹️ End Stream';
                    goLiveBtn.style.background = '#f44336';
                    this.updateStreamStatus('🔴 LIVE');
                    this.startStreamStats();
                    
                } else {
                    // End streaming
                    this.isStreaming = false;
                    goLiveBtn.textContent = '🔴 Go Live';
                    goLiveBtn.style.background = '#4CAF50';
                    this.updateStreamStatus('Stream ended');
                    this.stopStreamStats();
                }
            }

            updateStreamStatus(status) {
                document.getElementById('streamStatus').textContent = `Status: ${status}`;
            }

            startStreamStats() {
                const statsEl = document.getElementById('streamStats');
                statsEl.style.display = 'block';
                
                let duration = 0;
                let viewers = Math.floor(Math.random() * 50) + 1;
                
                this.statsInterval = setInterval(() => {
                    duration++;
                    viewers += Math.floor(Math.random() * 3) - 1;
                    viewers = Math.max(0, viewers);
                    
                    const hours = Math.floor(duration / 3600);
                    const minutes = Math.floor((duration % 3600) / 60);
                    const seconds = duration % 60;
                    
                    const timeStr = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    statsEl.textContent = `👁️ Viewers: ${viewers} | ⏱️ Duration: ${timeStr}`;
                }, 1000);
            }

            stopStreamStats() {
                document.getElementById('streamStats').style.display = 'none';
                if (this.statsInterval) {
                    clearInterval(this.statsInterval);
                }
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
                document.getElementById('theme-icon').textContent = '☀️';
            }

            // Initialize teleprompter
            teleprompter = new Teleprompter();

            // Initialize new features
            speechController = new SpeechController();
            socialStreamer = new SocialMediaStreamer();

            // Handle fullscreen changes
            document.addEventListener('fullscreenchange', function() {
                if (!document.fullscreenElement) {
                    document.body.classList.remove('fullscreen');
                }
            });

            console.log('Professional Teleprompter with Voice Control and Live Streaming initialized successfully!');
        });
    </script>
</body>
</html>